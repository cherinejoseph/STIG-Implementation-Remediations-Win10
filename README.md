## Programmatic Vulnerability Remediations: STIG Implementations - Win10 (Powershell)

## Introduction

In the world of cybersecurity, maintaining a secure environment is critical for mitigating vulnerabilities that can be exploited by attackers. One of the most widely recognized frameworks for hardening operating systems and applications is the **Security Technical Implementation Guide (STIG)**, which provides detailed configuration guidelines aimed at improving the security posture of IT systems.

STIGs are developed by the **Defense Information Systems Agency (DISA)** and are used primarily by the Department of Defense (DoD) and other federal agencies. These guides contain a series of security requirements designed to mitigate common vulnerabilities, ensure compliance, and reduce the risk of compromise. 

This repository is focused on automating the remediation of **STIGs** on Windows operating systems using **PowerShell scripts**. The scripts are designed to address specific security requirements outlined in each **STIG ID** and can be run in environments that need to adhere to DoD or similar security standards. 

Keep reading to see an example of how I handled a STIG implementation using PowerShell scripts for automation, and also the benefits of using automated remediation vs manual remediation. For detailed information on individual STIGs and their associated remediations, I made use of **[stigaview.com](https://stigaview.com/products/win10/v3r1/)**, a comprehensive resource that provides in-depth insights into each STIG.

---

## Repository Structure

The repository is organized into the following folders:

### 1. **[STIGS folder](https://github.com/cherinejoseph/STIG-Implementation-Remediations-Win10/tree/main/STIGS)**:
- Contains scripts to automate remediation for each STIG.
- Each STIG ID (e.g., **WN10-AU-000500**) has its own corresponding PowerShell script that configures the required settings automatically.

### 2. **[Manual Fix Folder](https://github.com/cherinejoseph/STIG-Implementation-Remediations-Win10/tree/main/Manual%20Fix)**:
- Provides step-by-step instructions for manually applying STIG configurations and **verifying the details** of each setting.
- This folder is helpful for users who want to manually check and apply STIG configurations or prefer to verify settings before making changes, or who want to make the necessary registry or group policy changes without using automation.

### 3. **[Script Test Photos](https://github.com/cherinejoseph/STIG-Implementation-Remediations-Win10/tree/main/Script-Test-Photos)**:
- Contains screenshots showing the **command-line output** after running the PowerShell script to remediate a STIG.
- These screenshots provide **confirmation of success**, showing the successful application of the configuration changes after executing the script.

---

## STIGs and Vulnerability Management

STIGs play a key role in vulnerability management. By following STIG guidelines, organizations can systematically address security gaps and reduce vulnerabilities in their systems. However, manually applying these security configurations can be tedious and prone to human error. 

This repository helps simplify the process by providing automated PowerShell scripts to remediate **Windows**-specific STIGs. These scripts are designed to ensure compliance with the security settings, minimizing vulnerabilities and improving overall system hardening.

## Vulnerability Scan Results

To identify which vulnerabilities needed remediation, I performed a vulnerability scan using Tenable. This scan helped pinpoint specific **STIG violations** and highlighted areas of non-compliance within the system. Each identified vulnerability directly corresponds to a **STIG ID**, which I have addressed in this repository with remediation scripts and manual fix instructions.

Below is an example screenshot of the **Tenable vulnerability scan results**, showing the specific STIG violations that needed remediation:

![Tenable Vulnerability Scan Results](https://github.com/cherinejoseph/STIG-Implementation-Remediations-Win10/blob/main/tenable-scan-WN10AU000500.png) 

The scan shows a variety of **failed STIGs** across the system. From this list, I selected **STIG ID: WN10-AU-000500**, which focuses on configuring the **Application Event Log size** to `32768 KB` or greater.

---

## Remediation Example: **STIG ID: WN10-AU-000500**

---

### **STIG ID: WN10-AU-000500**  
**Requirement**: The Application event log size must be configured to `32768 KB` or greater.

This STIG requires that the **Application Event Log Size** be configured to a minimum of `32768 KB` to ensure adequate logging and monitoring. Here is how I addressed this issue:

### **Step 1: Initial Scan Results (Failed)**

As part of the **vulnerability scan**, **STIG ID: WN10-AU-000500** was identified as a failure. Below is the **Tenable scan failure screenshot**, showing that the **Application Event Log Size** was not configured correctly:

![Tenable Scan Failure - WN10-AU-000500](https://github.com/cherinejoseph/STIG-Implementation-Remediations-Win10/blob/main/failed-WN10AU000500.png)

In this screenshot, the scan results clearly indicate that the **Application Event Log Size** was smaller than the required `32768 KB`, resulting in a failed compliance check.

### **Step 2: Remediating the Issue**

To fix this, I applied the appropriate **PowerShell script** that automatically adjusted the **Event Log Size** to meet the STIG requirement of `32768 KB`. You can find the remediation script in the **PowerShell Scripts Folder** for **[WN10-AU-000500](https://github.com/cherinejoseph/STIG-Implementation-Remediations-Win10/blob/main/STIGS/WN10-AU-000500.ps1)**.

### **Step 3: Re-scan After Remediation (Pass)**

After running the script to apply the required configuration, I performed a **re-scan** to verify the fix. The results showed that **STIG ID: WN10-AU-000500** was now in compliance.

Below is the screenshot showing the **successful scan results** after remediation:

![Tenable Scan Pass - WN10-AU-000500](https://github.com/cherinejoseph/STIG-Implementation-Remediations-Win10/blob/main/second-scan-passed-WN10AU000500.png)

In this screenshot, you can see that the **Application Event Log Size** is now correctly configured to `32768 KB`, and the scan results confirm the system has passed the STIG check.

---

## Benefits of Automation vs. Manual Remediation

- **Automation** (via PowerShell scripts):
  - **Time-efficient**: Automates repetitive tasks, saving time.
  - **Consistency**: Ensures that configurations are applied uniformly across systems.
  - **Reduced human error**: Automation minimizes the risk of manual mistakes.
  
- **Manual Remediation**:
  - **Control**: Gives the user full control over the system configuration.
  - **Learning Opportunity**: Provides insight into the underlying configurations and the ability to make other manual adjustments as needed.
  - **No reliance on scripts**: Useful if automation is not an option in some environments.
 

Automated vulnerability remediation is generally considered more effective for Security Technical Implementation Guides (STIGs) due to its efficiency, speed, and ability to manage the frequent updates required by STIGs. Manual processes, on the other hand, are often time-consuming and may cause delays in applying security updates, potentially leaving systems vulnerable for extended periods.

In contrast, automated tools can apply updates and configurations within hours, significantly reducing the time and effort required compared to manual methods. Additionally, automation ensures that systems remain compliant with the latest STIG standards, which are updated every 90 days.

This approach not only accelerates the implementation of new network applications and appliances but also reduces the overall cost of maintaining security policies. Automation further enables continuous monitoring and compliance, which is essential given the dynamic nature of cybersecurity threats and the need for ongoing audit readiness.

While manual audits can provide in-depth insights for smaller systems, automated scans are far more efficient for larger networks.

Overall, the shift towards automated STIG hardening has been driven by the need for faster, more reliable, and cost-effective solutions to maintain compliance and security.


## Windows 10 STIG Remediations Scripts
| STIG ID        | DESCRIPTION                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | LANGUAGE  | LINK                                                                                                                                                                                                                                                      |
|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| WN10-AC-000010 | This PowerShell script ensures that the account lockout feature, when enabled, prevents brute-force password attacks on the system. The higher this value is, the less effective the account lockout feature will be in protecting the local system. The number of bad logon attempts must be reasonably small to minimize the possibility of a successful password attack, while allowing for honest errors made during a normal user logon.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-AC-000010-Remediation.ps1)                                                                                                    |
| WN10-AC-000035 | This PowerShell script ensures that Information systems not protected with strong password schemes (including passwords of minimum length) provide the opportunity for anyone to crack the password, thus gaining access to the system and compromising the device, information, or the local network.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-AC-000035-Remediation.ps1)                                                                                                    |
| WN10-CC-000195 | This PowerShell script ensures that enhanced anti-spoofing for facial recognition must be enabled on Windows 10. Enhanced anti-spoofing provides additional protections when using facial recognition with devices that support it.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-CC-000195-Remediation.ps1)                                                                                                    |
| WN10-CC-000197 | This PowerShell script disables Microsoft consumer experiences to prevent the installation of suggested apps, while organizations can manage application execution through other methods like whitelisting.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-CC-000197-Remediation.ps1)                                                                                                    |
| WN10-CC-000206 | This PowerShell script ensures that Windows Update must not obtain updates from other PCs on the internet. Windows 10 allows Windows Update to obtain updates from additional sources instead of Microsoft. In addition to Microsoft, updates can be obtained from and sent to PCs on the local network as well as on the internet. This is part of the Windows Update trusted process; however, to minimize outside exposure, obtaining updates from or sending to systems on the internet must be prevented.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-CC-000206-Remediation.ps1)                                                                                                    |
| WN10-CC-000252 | This PowerShell script ensures that Windows 10 must be configured to disable Windows Game Recording and Broadcasting. Windows Game Recording and Broadcasting is intended for use with games, however it could potentially record screen shots of other applications and expose sensitive data. Disabling the feature will prevent this from occurring.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-CC-000252-Remediation.ps1)                                                                                                    |
| WN10-CC-000260 | This PowerShell script ensures that Windows 10 must be configured to require a minimum pin length of six characters or greater. Windows allows the use of PINs as well as biometrics for authentication without sending a password to a network or website where it could be compromised. Longer minimum PIN lengths increase the available combinations an attacker would have to attempt. Shorter minimum length significantly reduces the strength.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-CC-000260-Remediation.ps1)                                                                                                    |
| WN10-CC-000270 | Preventing password saving in the Remote Desktop Client is essential to avoid unauthorized users establishing remote desktop sessions.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-CC-000270-Remediation.ps1)                                                                                                    |
| WN10-CC-000290 | Enabling "High Level" encryption ensures Remote Desktop Services sessions are encrypted bidirectionally to protect data and sensitive information from interception.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-CC-000290-Remediation.ps1)                                                                                                    |
| WN10-CC-000327 | This PowerShell script ensures that PowerShell Transcription must be enabled on Windows 10. Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks. Audit logs are necessary to provide a trail of evidence in case the system or network is compromised. Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior. Enabling PowerShell Transcription will record detailed information from the processing of PowerShell commands and scripts. This can provide additional detail when malware has run on a system.                                                                                                                                                                                                            | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-CC-000327-Remediation.ps1)                                                                                                    |
| WN10-CC-000335 | This PowerShell script ensures that The Windows Remote Management (WinRM) client must not allow unencrypted traffic. Unencrypted remote access to a system can allow sensitive information to be compromised. Windows remote management connections must be encrypted to prevent this.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-CC-000335-Remediation.ps1)                                                                                                    |
| WN10-CC-000370 | This PowerShell script ensures that The convenience PIN for Windows 10 must be disabled. This policy controls whether a domain user can sign in using a convenience PIN to prevent enabling (Password Stuffer).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-CC-000370-Remediation.ps1)                                                                                                    |
| WN10-SO-000025 | This PowerShell script ensures that The built-in guest account must be renamed. The built-in guest account is a well-known user account on all Windows systems and, as initially installed, does not require a password. This can allow access to system resources by unauthorized users. Renaming this account to an unidentified name improves the protection of this account and the system.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-SO-000025-Remediation.ps1)                                                                                                    |
| WN10-SO-000070 | This PowerShell script ensures that the machine inactivity limit must be set to 15 minutes, locking the system with the screensaver. Unattended systems are susceptible to unauthorized use and should be locked when unattended. The screen saver should be set at a maximum of 15 minutes and be password protected. This protects critical and sensitive data from exposure to unauthorized personnel with physical access to the computer.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-SO-000070-Remediation.ps1)                                                                                                    |
| WN10-SO-000075 | This PowerShell script ensures that the required legal notice must be configured to display before console logon. Failure to display the logon banner prior to a logon attempt will negate legal proceedings resulting from unauthorized access to system resources.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-SO-000075-Remediation.ps1)                                                                                                    |
| WN10-SO-000100 | This PowerShell script ensures that the server message block (SMB) protocol provides the basis for many network operations. Digitally signed SMB packets aid in preventing man-in-the-middle attacks. If this policy is enabled, the SMB client will only communicate with an SMB server that performs SMB packet signing.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-SO-000100-Remediation.ps1)                                                                                                    |
| WN10-SO-000205 | This PowerShell script ensures that the Kerberos v5 authentication protocol is the default for authentication of users who are logging on to domain accounts. NTLM, which is less secure, is retained in later Windows versions for compatibility with clients and servers that are running earlier versions of Windows or applications that still use it. It is also used to authenticate logons to stand-alone computers that are running later versions.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-SO-000205-Remediation.ps1)                                                                                                    |
| WN10-SO-000245 | User Account Control (UAC) restricts privilege elevation and configures the built-in Administrator account to operate in Admin Approval Mode for enhanced security.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-SO-000245-Remediation.ps1)                                                                                                    |
| WN10-UC-000015 | This PowerShell script ensures that Toast notifications to the lock screen must be turned off. Toast notifications that are displayed on the lock screen could display sensitive information to unauthorized personnel. Turning off this feature will limit access to the information to a logged on user.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-UC-000015-Remediation.ps1)                                                                                                    |
| WN10-UR-000160 | This PowerShell script ensures that The Restore files and directories user right must only be assigned to the Administrators group. Inappropriate granting of user rights can provide system, administrative, and other high level capabilities. Accounts with the "Restore files and directories" user right can circumvent file and directory permissions and could allow access to sensitive data. It could also be used to over-write more current data.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Powershell | [View Script](https://github.com/churd-git/Programmatic-Vulnerability-Remediations/blob/main/STIG-ID-WN10-UR-000160-Remediation.ps1)                                                                                                    |
