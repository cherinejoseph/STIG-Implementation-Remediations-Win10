# WN10-AU-000500

## Vulnerability Discussion:
The Application event log is a critical component in recording events related to  
system activities, application errors, security audits, and other relevant system  
information. If the event log size is too small, it could fill up quickly, potentially  
losing vital audit data and making it more difficult for system administrators to  
track and analyze logs.  
This configuration ensures that the event log is large enough to handle the audit  
records generated by system activity, ensuring that logs don’t overflow,  
preventing loss of important event data.

## Check Criteria:
1. If the system is configured to send audit records directly to an audit  
server, then this requirement is not applicable.  
2. You need to verify the registry setting for the Application event log size:  
   - Registry Path:  
     `HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application\`  
   - Value Name: MaxSize  
   - Value Type: REG_DWORD  
   - Required Value: 0x00008000 (32768 KB or greater).

## Manual Fix for WN10-AU-000500:
To manually fix this issue, you’ll need to configure the Application event log size  
to 32768 KB (or greater) by modifying the registry.

### Step-by-Step Manual Fix:
1. Open the Registry Editor:  
   - Press Windows + R to open the Run dialog.  
   - Type `regedit` and press Enter. This will open the Registry Editor.  
2. Navigate to the Registry Path:  
   - In Registry Editor, navigate to the following path:  
     `HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application\`  
   - Expand HKEY_LOCAL_MACHINE  
   - Expand SOFTWARE  
   - Expand Policies  
   - Expand Microsoft  
   - Expand Windows  
   - Click on EventLog and then Application.  
3. Create or Modify the MaxSize Registry Value:  
   - If the MaxSize value doesn’t exist, you’ll need to create it:  
     1. Right-click on the Application key.  
     2. Select New > DWORD (32-bit) Value.  
     3. Name the new value MaxSize.  
   - Modify the Value:  
     1. Double-click the MaxSize value to edit it.  
     2. In the Edit DWORD (32-bit) Value window, set the Value data to  
        `0x00008000` (this represents 32768 KB).  
     3. Click OK to save the changes.  
4. Verify the Registry Setting:  
   - After modifying the registry, verify that the MaxSize value is set correctly:  
     1. Navigate back to  
        `HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application\`  
     2. Ensure that the MaxSize value exists and its Value data is  
        `0x00008000` (or greater).  
5. Restart the Event Log Service:  
   - For the changes to take effect, you may need to restart the Windows  
     Event Log service.  
   - You can do this by running the following command in PowerShell:  
     ```powershell
     Restart-Service -Name EventLog
     ```

This manual fix ensures that the Application event log has enough space to store  
audit records without quickly filling up, providing sufficient retention of system  
activity logs.
