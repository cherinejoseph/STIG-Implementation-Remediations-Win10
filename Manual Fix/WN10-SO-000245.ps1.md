# WN10-SO-000245

## Overview
The STIG ID **WN10-SO-000245** requires that **User Account Control (UAC) approval mode be enabled for the built-in Administrator account**. By default, this account runs all processes with full administrative privileges without prompts, making it more vulnerable to privilege escalation attacks. Enabling Admin Approval Mode helps prevent unauthorized elevation of privileges and enforces stricter control over administrative tasks.

---

## Description
The built-in Administrator account is a powerful local account with full system access. When Admin Approval Mode is disabled, actions requiring elevation are performed silently without user consent. Enabling this mode ensures that elevation requires explicit approval, thus reducing the risk of malware or unauthorized processes gaining elevated access. This setting enhances security by enforcing UAC behavior for this special account.

---

## Vulnerability Discussion

- The registry value `FilterAdministratorToken` controls whether the built-in Administrator account uses Admin Approval Mode.
- If this value is not enabled, the account operates with unrestricted administrative access, bypassing UAC prompts.
- Enabling this setting ensures that administrative tasks initiated under the built-in Administrator are subject to elevation prompts, reducing the risk of unauthorized privilege escalation.

---

## Manual Check

### ðŸ” Registry Check
1. Open **Registry Editor**:
    - Press `Win + R`, type `regedit`, and press Enter.
2. Navigate to the following registry key:
    ```
    HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
    ```
3. Check for the registry value:
    - **Name:** `FilterAdministratorToken`  
    - **Type:** `REG_DWORD`  
    - **Expected Value:** `1`

> âš ï¸ If the key is missing or the value is not set to `1`, this is a finding.

---

## Fix

You can fix this finding through either **Group Policy** or by editing the **Registry**.

### ðŸ› ï¸ Fix via Group Policy
1. Open **Group Policy Editor** (`gpedit.msc`).
2. Navigate to:
    ```
    Computer Configuration > Windows Settings > Security Settings > Local Policies > Security Options
    ```
3. Locate the policy:
    - **User Account Control: Admin Approval Mode for the Built-in Administrator account**
4. Set the policy to:
    - **Enabled**
5. Click **Apply**, then **OK**.
6. Run the following command to apply the change:
    ```
    gpupdate /force
    ```

---

### ðŸ› ï¸ Fix via Registry
1. Open **Registry Editor** (`regedit`).
2. Navigate to:
    ```
    HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
    ```
3. If the value `FilterAdministratorToken` does not exist:
    - Right-click in the right pane, select **New > DWORD (32-bit) Value**.
    - Name the value: `FilterAdministratorToken`
4. Set the value to:
    - `1` (Decimal)
5. Close Registry Editor.

> âœ… The change will apply after a system restart or by running `gpupdate /force`.

---

## Outcome

Enabling Admin Approval Mode for the built-in Administrator account ensures that even this privileged account cannot bypass UAC restrictions. This setting enforces explicit user consent for elevated actions and significantly reduces the attack surface related to silent privilege escalation. Enabling this setting aligns the system with **WN10-SO-000245** and strengthens local administrative security.
